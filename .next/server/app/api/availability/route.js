"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "app/api/availability/route";
exports.ids = ["app/api/availability/route"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/app-page.runtime.dev.js":
/*!*************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-page.runtime.dev.js" ***!
  \*************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-page.runtime.dev.js");

/***/ }),

/***/ "next/dist/compiled/next-server/app-route.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/app-route.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/app-route.runtime.dev.js");

/***/ }),

/***/ "(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Favailability%2Froute&page=%2Fapi%2Favailability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Favailability%2Froute.ts&appDir=C%3A%5CUsers%5Cmarco%5CDownloads%5Cled-rental-app-min%5Cled-rental-app%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmarco%5CDownloads%5Cled-rental-app-min%5Cled-rental-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!":
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Favailability%2Froute&page=%2Fapi%2Favailability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Favailability%2Froute.ts&appDir=C%3A%5CUsers%5Cmarco%5CDownloads%5Cled-rental-app-min%5Cled-rental-app%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmarco%5CDownloads%5Cled-rental-app-min%5Cled-rental-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D! ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   originalPathname: () => (/* binding */ originalPathname),\n/* harmony export */   patchFetch: () => (/* binding */ patchFetch),\n/* harmony export */   requestAsyncStorage: () => (/* binding */ requestAsyncStorage),\n/* harmony export */   routeModule: () => (/* binding */ routeModule),\n/* harmony export */   serverHooks: () => (/* binding */ serverHooks),\n/* harmony export */   staticGenerationAsyncStorage: () => (/* binding */ staticGenerationAsyncStorage)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/app-route/module.compiled */ \"(rsc)/./node_modules/next/dist/server/future/route-modules/app-route/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(rsc)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/server/lib/patch-fetch */ \"(rsc)/./node_modules/next/dist/server/lib/patch-fetch.js\");\n/* harmony import */ var next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var C_Users_marco_Downloads_led_rental_app_min_led_rental_app_src_app_api_availability_route_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src/app/api/availability/route.ts */ \"(rsc)/./src/app/api/availability/route.ts\");\n\n\n\n\n// We inject the nextConfigOutput here so that we can use them in the route\n// module.\nconst nextConfigOutput = \"\"\nconst routeModule = new next_dist_server_future_route_modules_app_route_module_compiled__WEBPACK_IMPORTED_MODULE_0__.AppRouteRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.APP_ROUTE,\n        page: \"/api/availability/route\",\n        pathname: \"/api/availability\",\n        filename: \"route\",\n        bundlePath: \"app/api/availability/route\"\n    },\n    resolvedPagePath: \"C:\\\\Users\\\\marco\\\\Downloads\\\\led-rental-app-min\\\\led-rental-app\\\\src\\\\app\\\\api\\\\availability\\\\route.ts\",\n    nextConfigOutput,\n    userland: C_Users_marco_Downloads_led_rental_app_min_led_rental_app_src_app_api_availability_route_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n// Pull out the exports that we need to expose from the module. This should\n// be eliminated when we've moved the other routes to the new format. These\n// are used to hook into the route.\nconst { requestAsyncStorage, staticGenerationAsyncStorage, serverHooks } = routeModule;\nconst originalPathname = \"/api/availability/route\";\nfunction patchFetch() {\n    return (0,next_dist_server_lib_patch_fetch__WEBPACK_IMPORTED_MODULE_2__.patchFetch)({\n        serverHooks,\n        staticGenerationAsyncStorage\n    });\n}\n\n\n//# sourceMappingURL=app-route.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LWFwcC1sb2FkZXIuanM/bmFtZT1hcHAlMkZhcGklMkZhdmFpbGFiaWxpdHklMkZyb3V0ZSZwYWdlPSUyRmFwaSUyRmF2YWlsYWJpbGl0eSUyRnJvdXRlJmFwcFBhdGhzPSZwYWdlUGF0aD1wcml2YXRlLW5leHQtYXBwLWRpciUyRmFwaSUyRmF2YWlsYWJpbGl0eSUyRnJvdXRlLnRzJmFwcERpcj1DJTNBJTVDVXNlcnMlNUNtYXJjbyU1Q0Rvd25sb2FkcyU1Q2xlZC1yZW50YWwtYXBwLW1pbiU1Q2xlZC1yZW50YWwtYXBwJTVDc3JjJTVDYXBwJnBhZ2VFeHRlbnNpb25zPXRzeCZwYWdlRXh0ZW5zaW9ucz10cyZwYWdlRXh0ZW5zaW9ucz1qc3gmcGFnZUV4dGVuc2lvbnM9anMmcm9vdERpcj1DJTNBJTVDVXNlcnMlNUNtYXJjbyU1Q0Rvd25sb2FkcyU1Q2xlZC1yZW50YWwtYXBwLW1pbiU1Q2xlZC1yZW50YWwtYXBwJmlzRGV2PXRydWUmdHNjb25maWdQYXRoPXRzY29uZmlnLmpzb24mYmFzZVBhdGg9JmFzc2V0UHJlZml4PSZuZXh0Q29uZmlnT3V0cHV0PSZwcmVmZXJyZWRSZWdpb249Jm1pZGRsZXdhcmVDb25maWc9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDYztBQUNzRDtBQUNuSTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsZ0hBQW1CO0FBQzNDO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWTtBQUNaLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxRQUFRLGlFQUFpRTtBQUN6RTtBQUNBO0FBQ0EsV0FBVyw0RUFBVztBQUN0QjtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ3VIOztBQUV2SCIsInNvdXJjZXMiOlsid2VicGFjazovL2xlZC1yZW50YWwtYXBwLz81ZjA4Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFwcFJvdXRlUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9hcHAtcm91dGUvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgcGF0Y2hGZXRjaCBhcyBfcGF0Y2hGZXRjaCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2xpYi9wYXRjaC1mZXRjaFwiO1xuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIkM6XFxcXFVzZXJzXFxcXG1hcmNvXFxcXERvd25sb2Fkc1xcXFxsZWQtcmVudGFsLWFwcC1taW5cXFxcbGVkLXJlbnRhbC1hcHBcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXZhaWxhYmlsaXR5XFxcXHJvdXRlLnRzXCI7XG4vLyBXZSBpbmplY3QgdGhlIG5leHRDb25maWdPdXRwdXQgaGVyZSBzbyB0aGF0IHdlIGNhbiB1c2UgdGhlbSBpbiB0aGUgcm91dGVcbi8vIG1vZHVsZS5cbmNvbnN0IG5leHRDb25maWdPdXRwdXQgPSBcIlwiXG5jb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBBcHBSb3V0ZVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5BUFBfUk9VVEUsXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9hdmFpbGFiaWxpdHkvcm91dGVcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9hdmFpbGFiaWxpdHlcIixcbiAgICAgICAgZmlsZW5hbWU6IFwicm91dGVcIixcbiAgICAgICAgYnVuZGxlUGF0aDogXCJhcHAvYXBpL2F2YWlsYWJpbGl0eS9yb3V0ZVwiXG4gICAgfSxcbiAgICByZXNvbHZlZFBhZ2VQYXRoOiBcIkM6XFxcXFVzZXJzXFxcXG1hcmNvXFxcXERvd25sb2Fkc1xcXFxsZWQtcmVudGFsLWFwcC1taW5cXFxcbGVkLXJlbnRhbC1hcHBcXFxcc3JjXFxcXGFwcFxcXFxhcGlcXFxcYXZhaWxhYmlsaXR5XFxcXHJvdXRlLnRzXCIsXG4gICAgbmV4dENvbmZpZ091dHB1dCxcbiAgICB1c2VybGFuZFxufSk7XG4vLyBQdWxsIG91dCB0aGUgZXhwb3J0cyB0aGF0IHdlIG5lZWQgdG8gZXhwb3NlIGZyb20gdGhlIG1vZHVsZS4gVGhpcyBzaG91bGRcbi8vIGJlIGVsaW1pbmF0ZWQgd2hlbiB3ZSd2ZSBtb3ZlZCB0aGUgb3RoZXIgcm91dGVzIHRvIHRoZSBuZXcgZm9ybWF0LiBUaGVzZVxuLy8gYXJlIHVzZWQgdG8gaG9vayBpbnRvIHRoZSByb3V0ZS5cbmNvbnN0IHsgcmVxdWVzdEFzeW5jU3RvcmFnZSwgc3RhdGljR2VuZXJhdGlvbkFzeW5jU3RvcmFnZSwgc2VydmVySG9va3MgfSA9IHJvdXRlTW9kdWxlO1xuY29uc3Qgb3JpZ2luYWxQYXRobmFtZSA9IFwiL2FwaS9hdmFpbGFiaWxpdHkvcm91dGVcIjtcbmZ1bmN0aW9uIHBhdGNoRmV0Y2goKSB7XG4gICAgcmV0dXJuIF9wYXRjaEZldGNoKHtcbiAgICAgICAgc2VydmVySG9va3MsXG4gICAgICAgIHN0YXRpY0dlbmVyYXRpb25Bc3luY1N0b3JhZ2VcbiAgICB9KTtcbn1cbmV4cG9ydCB7IHJvdXRlTW9kdWxlLCByZXF1ZXN0QXN5bmNTdG9yYWdlLCBzdGF0aWNHZW5lcmF0aW9uQXN5bmNTdG9yYWdlLCBzZXJ2ZXJIb29rcywgb3JpZ2luYWxQYXRobmFtZSwgcGF0Y2hGZXRjaCwgIH07XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWFwcC1yb3V0ZS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Favailability%2Froute&page=%2Fapi%2Favailability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Favailability%2Froute.ts&appDir=C%3A%5CUsers%5Cmarco%5CDownloads%5Cled-rental-app-min%5Cled-rental-app%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmarco%5CDownloads%5Cled-rental-app-min%5Cled-rental-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!\n");

/***/ }),

/***/ "(rsc)/./src/app/api/availability/route.ts":
/*!*******************************************!*\
  !*** ./src/app/api/availability/route.ts ***!
  \*******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   GET: () => (/* binding */ GET),\n/* harmony export */   POST: () => (/* binding */ POST)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(rsc)/./node_modules/next/dist/api/server.js\");\n/* harmony import */ var _lib_db__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/db */ \"(rsc)/./src/lib/db.ts\");\n\n\n// Função para obter companyId da sessão\nasync function getCompanyIdFromSession(request) {\n    try {\n        const sessionId = request.cookies.get(\"session-id\")?.value;\n        if (!sessionId) return null;\n        const parts = sessionId.split(\"_\");\n        if (parts.length < 2) return null;\n        const userId = parts[1];\n        if (!userId) return null;\n        // Buscar usuário para obter companyId\n        const user = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.user.findUnique({\n            where: {\n                id: userId\n            }\n        });\n        return user?.companyId || null;\n    } catch (error) {\n        console.error(\"Erro ao obter companyId:\", error);\n        return null;\n    }\n}\nasync function GET(request) {\n    try {\n        const companyId = await getCompanyIdFromSession(request);\n        if (!companyId) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"N\\xe3o autorizado\"\n            }, {\n                status: 401\n            });\n        }\n        // Buscar estoque atual (produtos, acessórios, equipamentos)\n        const [products, accessories, equipment] = await Promise.all([\n            _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.product.findMany({\n                where: {\n                    companyId\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    code: true,\n                    totalMeters: true,\n                    pricePerMeter: true\n                }\n            }),\n            _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.accessory.findMany({\n                where: {\n                    companyId\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    code: true,\n                    totalQty: true,\n                    pricePerUnit: true\n                }\n            }),\n            _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.equipment.findMany({\n                where: {\n                    companyId\n                },\n                select: {\n                    id: true,\n                    name: true,\n                    code: true,\n                    totalQty: true,\n                    pricePerUnit: true\n                }\n            })\n        ]);\n        // Buscar locações ativas (que podem estar ocupando itens)\n        const activeBookings = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.booking.findMany({\n            where: {\n                companyId,\n                status: {\n                    in: [\n                        \"CONFIRMED\",\n                        \"IN_PROGRESS\",\n                        \"PENDING\"\n                    ]\n                }\n            },\n            include: {\n                items: {\n                    include: {\n                        product: true\n                    }\n                },\n                accessories: {\n                    include: {\n                        accessory: true\n                    }\n                },\n                equipment: {\n                    include: {\n                        equipment: true\n                    }\n                },\n                client: {\n                    select: {\n                        name: true\n                    }\n                }\n            }\n        });\n        // Calcular disponibilidade atual\n        const currentAvailability = {\n            products: products.map((product)=>{\n                const occupiedMeters = activeBookings.reduce((total, booking)=>{\n                    return total + booking.items.filter((item)=>item.productId === product.id).reduce((sum, item)=>sum + item.meters, 0);\n                }, 0);\n                return {\n                    ...product,\n                    occupiedMeters,\n                    availableMeters: Math.max(0, product.totalMeters - occupiedMeters),\n                    utilizationPercent: product.totalMeters > 0 ? Math.round(occupiedMeters / product.totalMeters * 100) : 0,\n                    status: product.totalMeters - occupiedMeters > 0 ? \"DISPON\\xcdVEL\" : \"INDISPON\\xcdVEL\"\n                };\n            }),\n            accessories: accessories.map((accessory)=>{\n                const occupiedQty = activeBookings.reduce((total, booking)=>{\n                    return total + booking.accessories.filter((acc)=>acc.accessoryId === accessory.id).reduce((sum, acc)=>sum + acc.quantity, 0);\n                }, 0);\n                return {\n                    ...accessory,\n                    occupiedQty,\n                    availableQty: Math.max(0, accessory.totalQty - occupiedQty),\n                    utilizationPercent: accessory.totalQty > 0 ? Math.round(occupiedQty / accessory.totalQty * 100) : 0,\n                    status: accessory.totalQty - occupiedQty > 0 ? \"DISPON\\xcdVEL\" : \"INDISPON\\xcdVEL\"\n                };\n            }),\n            equipment: equipment.map((equip)=>{\n                const occupiedQty = activeBookings.reduce((total, booking)=>{\n                    return total + booking.equipment.filter((eq)=>eq.equipmentId === equip.id).reduce((sum, eq)=>sum + eq.quantity, 0);\n                }, 0);\n                return {\n                    ...equip,\n                    occupiedQty,\n                    availableQty: Math.max(0, equip.totalQty - occupiedQty),\n                    utilizationPercent: equip.totalQty > 0 ? Math.round(occupiedQty / equip.totalQty * 100) : 0,\n                    status: equip.totalQty - occupiedQty > 0 ? \"DISPON\\xcdVEL\" : \"INDISPON\\xcdVEL\"\n                };\n            })\n        };\n        // Resumo geral\n        const summary = {\n            totalProducts: products.length,\n            totalAccessories: accessories.length,\n            totalEquipment: equipment.length,\n            totalProductMeters: products.reduce((sum, p)=>sum + p.totalMeters, 0),\n            totalAccessoryQty: accessories.reduce((sum, a)=>sum + a.totalQty, 0),\n            totalEquipmentQty: equipment.reduce((sum, e)=>sum + e.totalQty, 0),\n            occupiedProductMeters: currentAvailability.products.reduce((sum, p)=>sum + p.occupiedMeters, 0),\n            occupiedAccessoryQty: currentAvailability.accessories.reduce((sum, a)=>sum + a.occupiedQty, 0),\n            occupiedEquipmentQty: currentAvailability.equipment.reduce((sum, e)=>sum + e.occupiedQty, 0),\n            availableProductMeters: currentAvailability.products.reduce((sum, p)=>sum + p.availableMeters, 0),\n            availableAccessoryQty: currentAvailability.accessories.reduce((sum, a)=>sum + a.availableQty, 0),\n            availableEquipmentQty: currentAvailability.equipment.reduce((sum, e)=>sum + e.availableQty, 0),\n            lastUpdated: new Date().toISOString()\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            currentAvailability,\n            summary,\n            activeBookings: activeBookings.length\n        });\n    } catch (error) {\n        console.error(\"Erro ao buscar disponibilidade:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Erro interno do servidor\"\n        }, {\n            status: 500\n        });\n    } finally{\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.$disconnect();\n    }\n}\nasync function POST(request) {\n    try {\n        const body = await request.json();\n        const { startDate, endDate, items } = body;\n        if (!startDate || !endDate || !items || items.length === 0) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"Datas de in\\xedcio/fim e itens s\\xe3o obrigat\\xf3rios\"\n            }, {\n                status: 400\n            });\n        }\n        const start = new Date(startDate);\n        const end = new Date(endDate);\n        if (start >= end) {\n            return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n                error: \"A data de in\\xedcio deve ser anterior \\xe0 data de fim\"\n            }, {\n                status: 400\n            });\n        }\n        // Buscar locações que se sobrepõem ao período solicitado\n        const overlappingBookings = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.booking.findMany({\n            where: {\n                AND: [\n                    {\n                        startDate: {\n                            lte: end\n                        }\n                    },\n                    {\n                        endDate: {\n                            gte: start\n                        }\n                    },\n                    {\n                        status: {\n                            in: [\n                                \"CONFIRMED\",\n                                \"IN_PROGRESS\",\n                                \"PENDING\"\n                            ]\n                        }\n                    }\n                ]\n            },\n            include: {\n                items: {\n                    include: {\n                        product: true\n                    }\n                },\n                accessories: {\n                    include: {\n                        accessory: true\n                    }\n                },\n                equipment: {\n                    include: {\n                        equipment: true\n                    }\n                },\n                client: {\n                    select: {\n                        name: true\n                    }\n                }\n            }\n        });\n        // Verificar disponibilidade para cada item solicitado\n        const availabilityResults = [];\n        let allAvailable = true;\n        for (const requestedItem of items){\n            const { type, id, quantity, unit } = requestedItem;\n            let itemInfo, occupiedQuantity, totalQuantity, availableQuantity;\n            let occupyingBookings = [];\n            switch(type){\n                case \"PRODUTO\":\n                    itemInfo = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.product.findUnique({\n                        where: {\n                            id\n                        }\n                    });\n                    if (itemInfo) {\n                        totalQuantity = itemInfo.totalMeters;\n                        occupiedQuantity = overlappingBookings.reduce((total, booking)=>{\n                            return total + booking.items.filter((item)=>item.productId === id).reduce((sum, item)=>sum + item.meters, 0);\n                        }, 0);\n                        availableQuantity = Math.max(0, totalQuantity - occupiedQuantity);\n                        // Buscar locações que estão ocupando este produto\n                        overlappingBookings.forEach((booking)=>{\n                            booking.items.forEach((item)=>{\n                                if (item.productId === id && item.meters > 0) {\n                                    occupyingBookings.push({\n                                        bookingId: booking.id,\n                                        eventTitle: booking.eventTitle,\n                                        clientName: booking.client.name,\n                                        startDate: booking.startDate,\n                                        endDate: booking.endDate,\n                                        occupiedQuantity: item.meters,\n                                        status: booking.status\n                                    });\n                                }\n                            });\n                        });\n                    }\n                    break;\n                case \"ACESS\\xd3RIO\":\n                    itemInfo = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.accessory.findUnique({\n                        where: {\n                            id\n                        }\n                    });\n                    if (itemInfo) {\n                        totalQuantity = itemInfo.totalQty;\n                        occupiedQuantity = overlappingBookings.reduce((total, booking)=>{\n                            return total + booking.accessories.filter((acc)=>acc.accessoryId === id).reduce((sum, acc)=>sum + acc.quantity, 0);\n                        }, 0);\n                        availableQuantity = Math.max(0, totalQuantity - occupiedQuantity);\n                        // Buscar locações que estão ocupando este acessório\n                        overlappingBookings.forEach((booking)=>{\n                            booking.accessories.forEach((acc)=>{\n                                if (acc.accessoryId === id && acc.quantity > 0) {\n                                    occupyingBookings.push({\n                                        bookingId: booking.id,\n                                        eventTitle: booking.eventTitle,\n                                        clientName: booking.client.name,\n                                        startDate: booking.startDate,\n                                        endDate: booking.endDate,\n                                        occupiedQuantity: acc.quantity,\n                                        status: booking.status\n                                    });\n                                }\n                            });\n                        });\n                    }\n                    break;\n                case \"EQUIPAMENTO\":\n                    itemInfo = await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.equipment.findUnique({\n                        where: {\n                            id\n                        }\n                    });\n                    if (itemInfo) {\n                        totalQuantity = itemInfo.totalQty;\n                        occupiedQuantity = overlappingBookings.reduce((total, booking)=>{\n                            return total + booking.equipment.filter((eq)=>eq.equipmentId === id).reduce((sum, eq)=>sum + eq.quantity, 0);\n                        }, 0);\n                        availableQuantity = Math.max(0, totalQuantity - occupiedQuantity);\n                        // Buscar locações que estão ocupando este equipamento\n                        overlappingBookings.forEach((booking)=>{\n                            booking.equipment.forEach((eq)=>{\n                                if (eq.equipmentId === id && eq.quantity > 0) {\n                                    occupyingBookings.push({\n                                        bookingId: booking.id,\n                                        eventTitle: booking.eventTitle,\n                                        clientName: booking.client.name,\n                                        startDate: booking.startDate,\n                                        endDate: booking.endDate,\n                                        occupiedQuantity: eq.quantity,\n                                        status: booking.status\n                                    });\n                                }\n                            });\n                        });\n                    }\n                    break;\n            }\n            if (itemInfo) {\n                const isAvailable = availableQuantity >= quantity;\n                if (!isAvailable) allAvailable = false;\n                availabilityResults.push({\n                    id,\n                    name: itemInfo.name,\n                    code: itemInfo.code,\n                    type,\n                    requestedQuantity: quantity,\n                    availableQuantity,\n                    totalQuantity,\n                    occupiedQuantity,\n                    unit,\n                    status: isAvailable ? \"DISPON\\xcdVEL\" : \"INDISPON\\xcdVEL\",\n                    reason: isAvailable ? undefined : `Quantidade insuficiente. Disponível: ${availableQuantity} ${unit}`,\n                    occupyingBookings\n                });\n            }\n        }\n        // Resumo da verificação\n        const summary = {\n            totalItems: items.length,\n            availableItems: availabilityResults.filter((item)=>item.status === \"DISPON\\xcdVEL\").length,\n            unavailableItems: availabilityResults.filter((item)=>item.status === \"INDISPON\\xcdVEL\").length,\n            generalStatus: allAvailable ? \"TOTALMENTE_DISPONIVEL\" : \"PARCIALMENTE_DISPONIVEL\"\n        };\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            success: true,\n            available: allAvailable,\n            results: availabilityResults,\n            summary,\n            period: {\n                startDate: start.toISOString(),\n                endDate: end.toISOString()\n            },\n            message: allAvailable ? \"Todos os itens est\\xe3o dispon\\xedveis para o per\\xedodo solicitado\" : \"Alguns itens n\\xe3o est\\xe3o dispon\\xedveis para o per\\xedodo solicitado\",\n            recommendation: allAvailable ? \"Pode prosseguir com a cria\\xe7\\xe3o da loca\\xe7\\xe3o\" : \"Verifique a disponibilidade dos itens indispon\\xedveis antes de prosseguir\"\n        });\n    } catch (error) {\n        console.error(\"Erro ao verificar disponibilidade:\", error);\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.json({\n            error: \"Erro interno do servidor\"\n        }, {\n            status: 500\n        });\n    } finally{\n        await _lib_db__WEBPACK_IMPORTED_MODULE_1__.prisma.$disconnect();\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QztvQkFDQUQ7b0JBQ0FEO29CQUNBRjtvQkFDQWhGLFFBQVEyRixjQUFjLGtCQUFlO29CQUNyQ0UsUUFBUUYsY0FBY0csWUFBWSxDQUFDLHFDQUFxQyxFQUFFVixrQkFBa0IsQ0FBQyxFQUFFSixLQUFLLENBQUM7b0JBQ3JHSztnQkFDRjtZQUNGO1FBQ0Y7UUFFQSx3QkFBd0I7UUFDeEIsTUFBTXhDLFVBQVU7WUFDZGtELFlBQVkzRSxNQUFNL0IsTUFBTTtZQUN4QjJHLGdCQUFnQnBCLG9CQUFvQmpELE1BQU0sQ0FBQ0MsQ0FBQUEsT0FBUUEsS0FBSzVCLE1BQU0sS0FBSyxpQkFBY1gsTUFBTTtZQUN2RjRHLGtCQUFrQnJCLG9CQUFvQmpELE1BQU0sQ0FBQ0MsQ0FBQUEsT0FBUUEsS0FBSzVCLE1BQU0sS0FBSyxtQkFBZ0JYLE1BQU07WUFDM0Y2RyxlQUFlckIsZUFBZSwwQkFBMEI7UUFDMUQ7UUFFQSxPQUFPbEcscURBQVlBLENBQUNvQixJQUFJLENBQUM7WUFDdkJpRSxTQUFTO1lBQ1RtQyxXQUFXdEI7WUFDWHVCLFNBQVN4QjtZQUNUL0I7WUFDQXdELFFBQVE7Z0JBQUVqQyxXQUFXRSxNQUFNUCxXQUFXO2dCQUFJTSxTQUFTRSxJQUFJUixXQUFXO1lBQUc7WUFDckV1QyxTQUFTekIsZUFDTCx3RUFDQTtZQUNKMEIsZ0JBQWdCMUIsZUFDWix5REFDQTtRQUNOO0lBRUYsRUFBRSxPQUFPakYsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMsc0NBQXNDQTtRQUNwRCxPQUFPakIscURBQVlBLENBQUNvQixJQUFJLENBQ3RCO1lBQUVILE9BQU87UUFBMkIsR0FDcEM7WUFBRUksUUFBUTtRQUFJO0lBRWxCLFNBQVU7UUFDUixNQUFNcEIsMkNBQU1BLENBQUNxRixXQUFXO0lBQzFCO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9sZWQtcmVudGFsLWFwcC8uL3NyYy9hcHAvYXBpL2F2YWlsYWJpbGl0eS9yb3V0ZS50cz9lZGFmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IE5leHRSZXF1ZXN0LCBOZXh0UmVzcG9uc2UgfSBmcm9tICduZXh0L3NlcnZlcidcclxuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnQC9saWIvZGInXHJcblxyXG4vLyBGdW7Dp8OjbyBwYXJhIG9idGVyIGNvbXBhbnlJZCBkYSBzZXNzw6NvXHJcbmFzeW5jIGZ1bmN0aW9uIGdldENvbXBhbnlJZEZyb21TZXNzaW9uKHJlcXVlc3Q6IE5leHRSZXF1ZXN0KTogUHJvbWlzZTxzdHJpbmcgfCBudWxsPiB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHNlc3Npb25JZCA9IHJlcXVlc3QuY29va2llcy5nZXQoJ3Nlc3Npb24taWQnKT8udmFsdWVcclxuICAgIGlmICghc2Vzc2lvbklkKSByZXR1cm4gbnVsbFxyXG4gICAgXHJcbiAgICBjb25zdCBwYXJ0cyA9IHNlc3Npb25JZC5zcGxpdCgnXycpXHJcbiAgICBpZiAocGFydHMubGVuZ3RoIDwgMikgcmV0dXJuIG51bGxcclxuICAgIFxyXG4gICAgY29uc3QgdXNlcklkID0gcGFydHNbMV1cclxuICAgIGlmICghdXNlcklkKSByZXR1cm4gbnVsbFxyXG4gICAgXHJcbiAgICAvLyBCdXNjYXIgdXN1w6FyaW8gcGFyYSBvYnRlciBjb21wYW55SWRcclxuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBwcmlzbWEudXNlci5maW5kVW5pcXVlKHtcclxuICAgICAgd2hlcmU6IHsgaWQ6IHVzZXJJZCB9XHJcbiAgICB9KVxyXG4gICAgXHJcbiAgICByZXR1cm4gdXNlcj8uY29tcGFueUlkIHx8IG51bGxcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcignRXJybyBhbyBvYnRlciBjb21wYW55SWQ6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gbnVsbFxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIEdFVChyZXF1ZXN0OiBOZXh0UmVxdWVzdCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBjb21wYW55SWQgPSBhd2FpdCBnZXRDb21wYW55SWRGcm9tU2Vzc2lvbihyZXF1ZXN0KVxyXG4gICAgXHJcbiAgICBpZiAoIWNvbXBhbnlJZCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ07Do28gYXV0b3JpemFkbycgfSxcclxuICAgICAgICB7IHN0YXR1czogNDAxIH1cclxuICAgICAgKVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBCdXNjYXIgZXN0b3F1ZSBhdHVhbCAocHJvZHV0b3MsIGFjZXNzw7NyaW9zLCBlcXVpcGFtZW50b3MpXHJcbiAgICBjb25zdCBbcHJvZHVjdHMsIGFjY2Vzc29yaWVzLCBlcXVpcG1lbnRdID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xyXG4gICAgICBwcmlzbWEucHJvZHVjdC5maW5kTWFueSh7XHJcbiAgICAgICAgd2hlcmU6IHsgY29tcGFueUlkIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgICBpZDogdHJ1ZSxcclxuICAgICAgICAgIG5hbWU6IHRydWUsXHJcbiAgICAgICAgICBjb2RlOiB0cnVlLFxyXG4gICAgICAgICAgdG90YWxNZXRlcnM6IHRydWUsXHJcbiAgICAgICAgICBwcmljZVBlck1ldGVyOiB0cnVlXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgcHJpc21hLmFjY2Vzc29yeS5maW5kTWFueSh7XHJcbiAgICAgICAgd2hlcmU6IHsgY29tcGFueUlkIH0sXHJcbiAgICAgICAgc2VsZWN0OiB7XHJcbiAgICAgICAgICBpZDogdHJ1ZSxcclxuICAgICAgICAgIG5hbWU6IHRydWUsXHJcbiAgICAgICAgICBjb2RlOiB0cnVlLFxyXG4gICAgICAgICAgdG90YWxRdHk6IHRydWUsXHJcbiAgICAgICAgICBwcmljZVBlclVuaXQ6IHRydWVcclxuICAgICAgICB9XHJcbiAgICAgIH0pLFxyXG4gICAgICBwcmlzbWEuZXF1aXBtZW50LmZpbmRNYW55KHtcclxuICAgICAgICB3aGVyZTogeyBjb21wYW55SWQgfSxcclxuICAgICAgICBzZWxlY3Q6IHtcclxuICAgICAgICAgIGlkOiB0cnVlLFxyXG4gICAgICAgICAgbmFtZTogdHJ1ZSxcclxuICAgICAgICAgIGNvZGU6IHRydWUsXHJcbiAgICAgICAgICB0b3RhbFF0eTogdHJ1ZSxcclxuICAgICAgICAgIHByaWNlUGVyVW5pdDogdHJ1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIF0pXHJcblxyXG4gICAgLy8gQnVzY2FyIGxvY2HDp8O1ZXMgYXRpdmFzIChxdWUgcG9kZW0gZXN0YXIgb2N1cGFuZG8gaXRlbnMpXHJcbiAgICBjb25zdCBhY3RpdmVCb29raW5ncyA9IGF3YWl0IHByaXNtYS5ib29raW5nLmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBjb21wYW55SWQsXHJcbiAgICAgICAgc3RhdHVzOiB7IGluOiBbJ0NPTkZJUk1FRCcsICdJTl9QUk9HUkVTUycsICdQRU5ESU5HJ10gfVxyXG4gICAgICB9LFxyXG4gICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgaXRlbXM6IHsgaW5jbHVkZTogeyBwcm9kdWN0OiB0cnVlIH0gfSxcclxuICAgICAgICBhY2Nlc3NvcmllczogeyBpbmNsdWRlOiB7IGFjY2Vzc29yeTogdHJ1ZSB9IH0sXHJcbiAgICAgICAgZXF1aXBtZW50OiB7IGluY2x1ZGU6IHsgZXF1aXBtZW50OiB0cnVlIH0gfSxcclxuICAgICAgICBjbGllbnQ6IHsgc2VsZWN0OiB7IG5hbWU6IHRydWUgfSB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgLy8gQ2FsY3VsYXIgZGlzcG9uaWJpbGlkYWRlIGF0dWFsXHJcbiAgICBjb25zdCBjdXJyZW50QXZhaWxhYmlsaXR5ID0ge1xyXG4gICAgICBwcm9kdWN0czogcHJvZHVjdHMubWFwKHByb2R1Y3QgPT4ge1xyXG4gICAgICAgIGNvbnN0IG9jY3VwaWVkTWV0ZXJzID0gYWN0aXZlQm9va2luZ3MucmVkdWNlKCh0b3RhbCwgYm9va2luZykgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIHRvdGFsICsgYm9va2luZy5pdGVtc1xyXG4gICAgICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gaXRlbS5wcm9kdWN0SWQgPT09IHByb2R1Y3QuaWQpXHJcbiAgICAgICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgaXRlbS5tZXRlcnMsIDApXHJcbiAgICAgICAgfSwgMClcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgLi4ucHJvZHVjdCxcclxuICAgICAgICAgIG9jY3VwaWVkTWV0ZXJzLFxyXG4gICAgICAgICAgYXZhaWxhYmxlTWV0ZXJzOiBNYXRoLm1heCgwLCBwcm9kdWN0LnRvdGFsTWV0ZXJzIC0gb2NjdXBpZWRNZXRlcnMpLFxyXG4gICAgICAgICAgdXRpbGl6YXRpb25QZXJjZW50OiBwcm9kdWN0LnRvdGFsTWV0ZXJzID4gMCBcclxuICAgICAgICAgICAgPyBNYXRoLnJvdW5kKChvY2N1cGllZE1ldGVycyAvIHByb2R1Y3QudG90YWxNZXRlcnMpICogMTAwKSBcclxuICAgICAgICAgICAgOiAwLFxyXG4gICAgICAgICAgc3RhdHVzOiAocHJvZHVjdC50b3RhbE1ldGVycyAtIG9jY3VwaWVkTWV0ZXJzKSA+IDAgPyAnRElTUE9Ow41WRUwnIDogJ0lORElTUE9Ow41WRUwnXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgYWNjZXNzb3JpZXM6IGFjY2Vzc29yaWVzLm1hcChhY2Nlc3NvcnkgPT4ge1xyXG4gICAgICAgIGNvbnN0IG9jY3VwaWVkUXR5ID0gYWN0aXZlQm9va2luZ3MucmVkdWNlKCh0b3RhbCwgYm9va2luZykgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuIHRvdGFsICsgYm9va2luZy5hY2Nlc3Nvcmllc1xyXG4gICAgICAgICAgICAuZmlsdGVyKGFjYyA9PiBhY2MuYWNjZXNzb3J5SWQgPT09IGFjY2Vzc29yeS5pZClcclxuICAgICAgICAgICAgLnJlZHVjZSgoc3VtLCBhY2MpID0+IHN1bSArIGFjYy5xdWFudGl0eSwgMClcclxuICAgICAgICB9LCAwKVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAuLi5hY2Nlc3NvcnksXHJcbiAgICAgICAgICBvY2N1cGllZFF0eSxcclxuICAgICAgICAgIGF2YWlsYWJsZVF0eTogTWF0aC5tYXgoMCwgYWNjZXNzb3J5LnRvdGFsUXR5IC0gb2NjdXBpZWRRdHkpLFxyXG4gICAgICAgICAgdXRpbGl6YXRpb25QZXJjZW50OiBhY2Nlc3NvcnkudG90YWxRdHkgPiAwIFxyXG4gICAgICAgICAgICA/IE1hdGgucm91bmQoKG9jY3VwaWVkUXR5IC8gYWNjZXNzb3J5LnRvdGFsUXR5KSAqIDEwMCkgXHJcbiAgICAgICAgICAgIDogMCxcclxuICAgICAgICAgIHN0YXR1czogKGFjY2Vzc29yeS50b3RhbFF0eSAtIG9jY3VwaWVkUXR5KSA+IDAgPyAnRElTUE9Ow41WRUwnIDogJ0lORElTUE9Ow41WRUwnXHJcbiAgICAgICAgfVxyXG4gICAgICB9KSxcclxuICAgICAgZXF1aXBtZW50OiBlcXVpcG1lbnQubWFwKGVxdWlwID0+IHtcclxuICAgICAgICBjb25zdCBvY2N1cGllZFF0eSA9IGFjdGl2ZUJvb2tpbmdzLnJlZHVjZSgodG90YWwsIGJvb2tpbmcpID0+IHtcclxuICAgICAgICAgIHJldHVybiB0b3RhbCArIGJvb2tpbmcuZXF1aXBtZW50XHJcbiAgICAgICAgICAgIC5maWx0ZXIoZXEgPT4gZXEuZXF1aXBtZW50SWQgPT09IGVxdWlwLmlkKVxyXG4gICAgICAgICAgICAucmVkdWNlKChzdW0sIGVxKSA9PiBzdW0gKyBlcS5xdWFudGl0eSwgMClcclxuICAgICAgICB9LCAwKVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAuLi5lcXVpcCxcclxuICAgICAgICAgIG9jY3VwaWVkUXR5LFxyXG4gICAgICAgICAgYXZhaWxhYmxlUXR5OiBNYXRoLm1heCgwLCBlcXVpcC50b3RhbFF0eSAtIG9jY3VwaWVkUXR5KSxcclxuICAgICAgICAgIHV0aWxpemF0aW9uUGVyY2VudDogZXF1aXAudG90YWxRdHkgPiAwIFxyXG4gICAgICAgICAgICA/IE1hdGgucm91bmQoKG9jY3VwaWVkUXR5IC8gZXF1aXAudG90YWxRdHkpICogMTAwKSBcclxuICAgICAgICAgICAgOiAwLFxyXG4gICAgICAgICAgc3RhdHVzOiAoZXF1aXAudG90YWxRdHkgLSBvY2N1cGllZFF0eSkgPiAwID8gJ0RJU1BPTsONVkVMJyA6ICdJTkRJU1BPTsONVkVMJ1xyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXN1bW8gZ2VyYWxcclxuICAgIGNvbnN0IHN1bW1hcnkgPSB7XHJcbiAgICAgIHRvdGFsUHJvZHVjdHM6IHByb2R1Y3RzLmxlbmd0aCxcclxuICAgICAgdG90YWxBY2Nlc3NvcmllczogYWNjZXNzb3JpZXMubGVuZ3RoLFxyXG4gICAgICB0b3RhbEVxdWlwbWVudDogZXF1aXBtZW50Lmxlbmd0aCxcclxuICAgICAgdG90YWxQcm9kdWN0TWV0ZXJzOiBwcm9kdWN0cy5yZWR1Y2UoKHN1bSwgcCkgPT4gc3VtICsgcC50b3RhbE1ldGVycywgMCksXHJcbiAgICAgIHRvdGFsQWNjZXNzb3J5UXR5OiBhY2Nlc3Nvcmllcy5yZWR1Y2UoKHN1bSwgYSkgPT4gc3VtICsgYS50b3RhbFF0eSwgMCksXHJcbiAgICAgIHRvdGFsRXF1aXBtZW50UXR5OiBlcXVpcG1lbnQucmVkdWNlKChzdW0sIGUpID0+IHN1bSArIGUudG90YWxRdHksIDApLFxyXG4gICAgICBvY2N1cGllZFByb2R1Y3RNZXRlcnM6IGN1cnJlbnRBdmFpbGFiaWxpdHkucHJvZHVjdHMucmVkdWNlKChzdW0sIHApID0+IHN1bSArIHAub2NjdXBpZWRNZXRlcnMsIDApLFxyXG4gICAgICBvY2N1cGllZEFjY2Vzc29yeVF0eTogY3VycmVudEF2YWlsYWJpbGl0eS5hY2Nlc3Nvcmllcy5yZWR1Y2UoKHN1bSwgYSkgPT4gc3VtICsgYS5vY2N1cGllZFF0eSwgMCksXHJcbiAgICAgIG9jY3VwaWVkRXF1aXBtZW50UXR5OiBjdXJyZW50QXZhaWxhYmlsaXR5LmVxdWlwbWVudC5yZWR1Y2UoKHN1bSwgZSkgPT4gc3VtICsgZS5vY2N1cGllZFF0eSwgMCksXHJcbiAgICAgIGF2YWlsYWJsZVByb2R1Y3RNZXRlcnM6IGN1cnJlbnRBdmFpbGFiaWxpdHkucHJvZHVjdHMucmVkdWNlKChzdW0sIHApID0+IHN1bSArIHAuYXZhaWxhYmxlTWV0ZXJzLCAwKSxcclxuICAgICAgYXZhaWxhYmxlQWNjZXNzb3J5UXR5OiBjdXJyZW50QXZhaWxhYmlsaXR5LmFjY2Vzc29yaWVzLnJlZHVjZSgoc3VtLCBhKSA9PiBzdW0gKyBhLmF2YWlsYWJsZVF0eSwgMCksXHJcbiAgICAgIGF2YWlsYWJsZUVxdWlwbWVudFF0eTogY3VycmVudEF2YWlsYWJpbGl0eS5lcXVpcG1lbnQucmVkdWNlKChzdW0sIGUpID0+IHN1bSArIGUuYXZhaWxhYmxlUXR5LCAwKSxcclxuICAgICAgbGFzdFVwZGF0ZWQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKVxyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbih7XHJcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXHJcbiAgICAgIGN1cnJlbnRBdmFpbGFiaWxpdHksXHJcbiAgICAgIHN1bW1hcnksXHJcbiAgICAgIGFjdGl2ZUJvb2tpbmdzOiBhY3RpdmVCb29raW5ncy5sZW5ndGhcclxuICAgIH0pXHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIGJ1c2NhciBkaXNwb25pYmlsaWRhZGU6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6ICdFcnJvIGludGVybm8gZG8gc2Vydmlkb3InIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKVxyXG4gIH0gZmluYWxseSB7XHJcbiAgICBhd2FpdCBwcmlzbWEuJGRpc2Nvbm5lY3QoKVxyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIFBPU1QocmVxdWVzdDogTmV4dFJlcXVlc3QpIHtcclxuICB0cnkge1xyXG4gICAgY29uc3QgYm9keSA9IGF3YWl0IHJlcXVlc3QuanNvbigpXHJcbiAgICBjb25zdCB7IHN0YXJ0RGF0ZSwgZW5kRGF0ZSwgaXRlbXMgfSA9IGJvZHlcclxuXHJcbiAgICBpZiAoIXN0YXJ0RGF0ZSB8fCAhZW5kRGF0ZSB8fCAhaXRlbXMgfHwgaXRlbXMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgIHJldHVybiBOZXh0UmVzcG9uc2UuanNvbihcclxuICAgICAgICB7IGVycm9yOiAnRGF0YXMgZGUgaW7DrWNpby9maW0gZSBpdGVucyBzw6NvIG9icmlnYXTDs3Jpb3MnIH0sXHJcbiAgICAgICAgeyBzdGF0dXM6IDQwMCB9XHJcbiAgICAgIClcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBzdGFydCA9IG5ldyBEYXRlKHN0YXJ0RGF0ZSlcclxuICAgIGNvbnN0IGVuZCA9IG5ldyBEYXRlKGVuZERhdGUpXHJcblxyXG4gICAgaWYgKHN0YXJ0ID49IGVuZCkge1xyXG4gICAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgICAgeyBlcnJvcjogJ0EgZGF0YSBkZSBpbsOtY2lvIGRldmUgc2VyIGFudGVyaW9yIMOgIGRhdGEgZGUgZmltJyB9LFxyXG4gICAgICAgIHsgc3RhdHVzOiA0MDAgfVxyXG4gICAgICApXHJcbiAgICB9XHJcblxyXG4gICAgLy8gQnVzY2FyIGxvY2HDp8O1ZXMgcXVlIHNlIHNvYnJlcMO1ZW0gYW8gcGVyw61vZG8gc29saWNpdGFkb1xyXG4gICAgY29uc3Qgb3ZlcmxhcHBpbmdCb29raW5ncyA9IGF3YWl0IHByaXNtYS5ib29raW5nLmZpbmRNYW55KHtcclxuICAgICAgd2hlcmU6IHtcclxuICAgICAgICBBTkQ6IFtcclxuICAgICAgICAgIHsgc3RhcnREYXRlOiB7IGx0ZTogZW5kIH0gfSxcclxuICAgICAgICAgIHsgZW5kRGF0ZTogeyBndGU6IHN0YXJ0IH0gfSxcclxuICAgICAgICAgIHsgc3RhdHVzOiB7IGluOiBbJ0NPTkZJUk1FRCcsICdJTl9QUk9HUkVTUycsICdQRU5ESU5HJ10gfSB9XHJcbiAgICAgICAgXVxyXG4gICAgICB9LFxyXG4gICAgICBpbmNsdWRlOiB7XHJcbiAgICAgICAgaXRlbXM6IHsgaW5jbHVkZTogeyBwcm9kdWN0OiB0cnVlIH0gfSxcclxuICAgICAgICBhY2Nlc3NvcmllczogeyBpbmNsdWRlOiB7IGFjY2Vzc29yeTogdHJ1ZSB9IH0sXHJcbiAgICAgICAgZXF1aXBtZW50OiB7IGluY2x1ZGU6IHsgZXF1aXBtZW50OiB0cnVlIH0gfSxcclxuICAgICAgICBjbGllbnQ6IHsgc2VsZWN0OiB7IG5hbWU6IHRydWUgfSB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcblxyXG4gICAgLy8gVmVyaWZpY2FyIGRpc3BvbmliaWxpZGFkZSBwYXJhIGNhZGEgaXRlbSBzb2xpY2l0YWRvXHJcbiAgICBjb25zdCBhdmFpbGFiaWxpdHlSZXN1bHRzID0gW11cclxuICAgIGxldCBhbGxBdmFpbGFibGUgPSB0cnVlXHJcblxyXG4gICAgZm9yIChjb25zdCByZXF1ZXN0ZWRJdGVtIG9mIGl0ZW1zKSB7XHJcbiAgICAgIGNvbnN0IHsgdHlwZSwgaWQsIHF1YW50aXR5LCB1bml0IH0gPSByZXF1ZXN0ZWRJdGVtXHJcbiAgICAgIFxyXG4gICAgICBsZXQgaXRlbUluZm8sIG9jY3VwaWVkUXVhbnRpdHksIHRvdGFsUXVhbnRpdHksIGF2YWlsYWJsZVF1YW50aXR5XHJcbiAgICAgIGxldCBvY2N1cHlpbmdCb29raW5ncyA9IFtdXHJcblxyXG4gICAgICBzd2l0Y2ggKHR5cGUpIHtcclxuICAgICAgICBjYXNlICdQUk9EVVRPJzpcclxuICAgICAgICAgIGl0ZW1JbmZvID0gYXdhaXQgcHJpc21hLnByb2R1Y3QuZmluZFVuaXF1ZSh7IHdoZXJlOiB7IGlkIH0gfSlcclxuICAgICAgICAgIGlmIChpdGVtSW5mbykge1xyXG4gICAgICAgICAgICB0b3RhbFF1YW50aXR5ID0gaXRlbUluZm8udG90YWxNZXRlcnNcclxuICAgICAgICAgICAgb2NjdXBpZWRRdWFudGl0eSA9IG92ZXJsYXBwaW5nQm9va2luZ3MucmVkdWNlKCh0b3RhbCwgYm9va2luZykgPT4ge1xyXG4gICAgICAgICAgICAgIHJldHVybiB0b3RhbCArIGJvb2tpbmcuaXRlbXNcclxuICAgICAgICAgICAgICAgIC5maWx0ZXIoaXRlbSA9PiBpdGVtLnByb2R1Y3RJZCA9PT0gaWQpXHJcbiAgICAgICAgICAgICAgICAucmVkdWNlKChzdW0sIGl0ZW0pID0+IHN1bSArIGl0ZW0ubWV0ZXJzLCAwKVxyXG4gICAgICAgICAgICB9LCAwKVxyXG4gICAgICAgICAgICBhdmFpbGFibGVRdWFudGl0eSA9IE1hdGgubWF4KDAsIHRvdGFsUXVhbnRpdHkgLSBvY2N1cGllZFF1YW50aXR5KVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQnVzY2FyIGxvY2HDp8O1ZXMgcXVlIGVzdMOjbyBvY3VwYW5kbyBlc3RlIHByb2R1dG9cclxuICAgICAgICAgICAgb3ZlcmxhcHBpbmdCb29raW5ncy5mb3JFYWNoKGJvb2tpbmcgPT4ge1xyXG4gICAgICAgICAgICAgIGJvb2tpbmcuaXRlbXMuZm9yRWFjaChpdGVtID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChpdGVtLnByb2R1Y3RJZCA9PT0gaWQgJiYgaXRlbS5tZXRlcnMgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgIG9jY3VweWluZ0Jvb2tpbmdzLnB1c2goe1xyXG4gICAgICAgICAgICAgICAgICAgIGJvb2tpbmdJZDogYm9va2luZy5pZCxcclxuICAgICAgICAgICAgICAgICAgICBldmVudFRpdGxlOiBib29raW5nLmV2ZW50VGl0bGUsXHJcbiAgICAgICAgICAgICAgICAgICAgY2xpZW50TmFtZTogYm9va2luZy5jbGllbnQubmFtZSxcclxuICAgICAgICAgICAgICAgICAgICBzdGFydERhdGU6IGJvb2tpbmcuc3RhcnREYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgIGVuZERhdGU6IGJvb2tpbmcuZW5kRGF0ZSxcclxuICAgICAgICAgICAgICAgICAgICBvY2N1cGllZFF1YW50aXR5OiBpdGVtLm1ldGVycyxcclxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IGJvb2tpbmcuc3RhdHVzXHJcbiAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrXHJcblxyXG4gICAgICAgIGNhc2UgJ0FDRVNTw5NSSU8nOlxyXG4gICAgICAgICAgaXRlbUluZm8gPSBhd2FpdCBwcmlzbWEuYWNjZXNzb3J5LmZpbmRVbmlxdWUoeyB3aGVyZTogeyBpZCB9IH0pXHJcbiAgICAgICAgICBpZiAoaXRlbUluZm8pIHtcclxuICAgICAgICAgICAgdG90YWxRdWFudGl0eSA9IGl0ZW1JbmZvLnRvdGFsUXR5XHJcbiAgICAgICAgICAgIG9jY3VwaWVkUXVhbnRpdHkgPSBvdmVybGFwcGluZ0Jvb2tpbmdzLnJlZHVjZSgodG90YWwsIGJvb2tpbmcpID0+IHtcclxuICAgICAgICAgICAgICByZXR1cm4gdG90YWwgKyBib29raW5nLmFjY2Vzc29yaWVzXHJcbiAgICAgICAgICAgICAgICAuZmlsdGVyKGFjYyA9PiBhY2MuYWNjZXNzb3J5SWQgPT09IGlkKVxyXG4gICAgICAgICAgICAgICAgLnJlZHVjZSgoc3VtLCBhY2MpID0+IHN1bSArIGFjYy5xdWFudGl0eSwgMClcclxuICAgICAgICAgICAgfSwgMClcclxuICAgICAgICAgICAgYXZhaWxhYmxlUXVhbnRpdHkgPSBNYXRoLm1heCgwLCB0b3RhbFF1YW50aXR5IC0gb2NjdXBpZWRRdWFudGl0eSlcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEJ1c2NhciBsb2Nhw6fDtWVzIHF1ZSBlc3TDo28gb2N1cGFuZG8gZXN0ZSBhY2Vzc8OzcmlvXHJcbiAgICAgICAgICAgIG92ZXJsYXBwaW5nQm9va2luZ3MuZm9yRWFjaChib29raW5nID0+IHtcclxuICAgICAgICAgICAgICBib29raW5nLmFjY2Vzc29yaWVzLmZvckVhY2goYWNjID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChhY2MuYWNjZXNzb3J5SWQgPT09IGlkICYmIGFjYy5xdWFudGl0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgb2NjdXB5aW5nQm9va2luZ3MucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9va2luZ0lkOiBib29raW5nLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50VGl0bGU6IGJvb2tpbmcuZXZlbnRUaXRsZSxcclxuICAgICAgICAgICAgICAgICAgICBjbGllbnROYW1lOiBib29raW5nLmNsaWVudC5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZTogYm9va2luZy5zdGFydERhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZTogYm9va2luZy5lbmREYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgIG9jY3VwaWVkUXVhbnRpdHk6IGFjYy5xdWFudGl0eSxcclxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IGJvb2tpbmcuc3RhdHVzXHJcbiAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrXHJcblxyXG4gICAgICAgIGNhc2UgJ0VRVUlQQU1FTlRPJzpcclxuICAgICAgICAgIGl0ZW1JbmZvID0gYXdhaXQgcHJpc21hLmVxdWlwbWVudC5maW5kVW5pcXVlKHsgd2hlcmU6IHsgaWQgfSB9KVxyXG4gICAgICAgICAgaWYgKGl0ZW1JbmZvKSB7XHJcbiAgICAgICAgICAgIHRvdGFsUXVhbnRpdHkgPSBpdGVtSW5mby50b3RhbFF0eVxyXG4gICAgICAgICAgICBvY2N1cGllZFF1YW50aXR5ID0gb3ZlcmxhcHBpbmdCb29raW5ncy5yZWR1Y2UoKHRvdGFsLCBib29raW5nKSA9PiB7XHJcbiAgICAgICAgICAgICAgcmV0dXJuIHRvdGFsICsgYm9va2luZy5lcXVpcG1lbnRcclxuICAgICAgICAgICAgICAgIC5maWx0ZXIoZXEgPT4gZXEuZXF1aXBtZW50SWQgPT09IGlkKVxyXG4gICAgICAgICAgICAgICAgLnJlZHVjZSgoc3VtLCBlcSkgPT4gc3VtICsgZXEucXVhbnRpdHksIDApXHJcbiAgICAgICAgICAgIH0sIDApXHJcbiAgICAgICAgICAgIGF2YWlsYWJsZVF1YW50aXR5ID0gTWF0aC5tYXgoMCwgdG90YWxRdWFudGl0eSAtIG9jY3VwaWVkUXVhbnRpdHkpXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBCdXNjYXIgbG9jYcOnw7VlcyBxdWUgZXN0w6NvIG9jdXBhbmRvIGVzdGUgZXF1aXBhbWVudG9cclxuICAgICAgICAgICAgb3ZlcmxhcHBpbmdCb29raW5ncy5mb3JFYWNoKGJvb2tpbmcgPT4ge1xyXG4gICAgICAgICAgICAgIGJvb2tpbmcuZXF1aXBtZW50LmZvckVhY2goZXEgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKGVxLmVxdWlwbWVudElkID09PSBpZCAmJiBlcS5xdWFudGl0eSA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgb2NjdXB5aW5nQm9va2luZ3MucHVzaCh7XHJcbiAgICAgICAgICAgICAgICAgICAgYm9va2luZ0lkOiBib29raW5nLmlkLFxyXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50VGl0bGU6IGJvb2tpbmcuZXZlbnRUaXRsZSxcclxuICAgICAgICAgICAgICAgICAgICBjbGllbnROYW1lOiBib29raW5nLmNsaWVudC5uYW1lLFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZTogYm9va2luZy5zdGFydERhdGUsXHJcbiAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZTogYm9va2luZy5lbmREYXRlLFxyXG4gICAgICAgICAgICAgICAgICAgIG9jY3VwaWVkUXVhbnRpdHk6IGVxLnF1YW50aXR5LFxyXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czogYm9va2luZy5zdGF0dXNcclxuICAgICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgfVxyXG5cclxuICAgICAgaWYgKGl0ZW1JbmZvKSB7XHJcbiAgICAgICAgY29uc3QgaXNBdmFpbGFibGUgPSBhdmFpbGFibGVRdWFudGl0eSA+PSBxdWFudGl0eVxyXG4gICAgICAgIGlmICghaXNBdmFpbGFibGUpIGFsbEF2YWlsYWJsZSA9IGZhbHNlXHJcblxyXG4gICAgICAgIGF2YWlsYWJpbGl0eVJlc3VsdHMucHVzaCh7XHJcbiAgICAgICAgICBpZCxcclxuICAgICAgICAgIG5hbWU6IGl0ZW1JbmZvLm5hbWUsXHJcbiAgICAgICAgICBjb2RlOiBpdGVtSW5mby5jb2RlLFxyXG4gICAgICAgICAgdHlwZSxcclxuICAgICAgICAgIHJlcXVlc3RlZFF1YW50aXR5OiBxdWFudGl0eSxcclxuICAgICAgICAgIGF2YWlsYWJsZVF1YW50aXR5LFxyXG4gICAgICAgICAgdG90YWxRdWFudGl0eSxcclxuICAgICAgICAgIG9jY3VwaWVkUXVhbnRpdHksXHJcbiAgICAgICAgICB1bml0LFxyXG4gICAgICAgICAgc3RhdHVzOiBpc0F2YWlsYWJsZSA/ICdESVNQT07DjVZFTCcgOiAnSU5ESVNQT07DjVZFTCcsXHJcbiAgICAgICAgICByZWFzb246IGlzQXZhaWxhYmxlID8gdW5kZWZpbmVkIDogYFF1YW50aWRhZGUgaW5zdWZpY2llbnRlLiBEaXNwb27DrXZlbDogJHthdmFpbGFibGVRdWFudGl0eX0gJHt1bml0fWAsXHJcbiAgICAgICAgICBvY2N1cHlpbmdCb29raW5nc1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvLyBSZXN1bW8gZGEgdmVyaWZpY2HDp8Ojb1xyXG4gICAgY29uc3Qgc3VtbWFyeSA9IHtcclxuICAgICAgdG90YWxJdGVtczogaXRlbXMubGVuZ3RoLFxyXG4gICAgICBhdmFpbGFibGVJdGVtczogYXZhaWxhYmlsaXR5UmVzdWx0cy5maWx0ZXIoaXRlbSA9PiBpdGVtLnN0YXR1cyA9PT0gJ0RJU1BPTsONVkVMJykubGVuZ3RoLFxyXG4gICAgICB1bmF2YWlsYWJsZUl0ZW1zOiBhdmFpbGFiaWxpdHlSZXN1bHRzLmZpbHRlcihpdGVtID0+IGl0ZW0uc3RhdHVzID09PSAnSU5ESVNQT07DjVZFTCcpLmxlbmd0aCxcclxuICAgICAgZ2VuZXJhbFN0YXR1czogYWxsQXZhaWxhYmxlID8gJ1RPVEFMTUVOVEVfRElTUE9OSVZFTCcgOiAnUEFSQ0lBTE1FTlRFX0RJU1BPTklWRUwnXHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5qc29uKHtcclxuICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgYXZhaWxhYmxlOiBhbGxBdmFpbGFibGUsXHJcbiAgICAgIHJlc3VsdHM6IGF2YWlsYWJpbGl0eVJlc3VsdHMsXHJcbiAgICAgIHN1bW1hcnksXHJcbiAgICAgIHBlcmlvZDogeyBzdGFydERhdGU6IHN0YXJ0LnRvSVNPU3RyaW5nKCksIGVuZERhdGU6IGVuZC50b0lTT1N0cmluZygpIH0sXHJcbiAgICAgIG1lc3NhZ2U6IGFsbEF2YWlsYWJsZSBcclxuICAgICAgICA/ICdUb2RvcyBvcyBpdGVucyBlc3TDo28gZGlzcG9uw612ZWlzIHBhcmEgbyBwZXLDrW9kbyBzb2xpY2l0YWRvJ1xyXG4gICAgICAgIDogJ0FsZ3VucyBpdGVucyBuw6NvIGVzdMOjbyBkaXNwb27DrXZlaXMgcGFyYSBvIHBlcsOtb2RvIHNvbGljaXRhZG8nLFxyXG4gICAgICByZWNvbW1lbmRhdGlvbjogYWxsQXZhaWxhYmxlIFxyXG4gICAgICAgID8gJ1BvZGUgcHJvc3NlZ3VpciBjb20gYSBjcmlhw6fDo28gZGEgbG9jYcOnw6NvJ1xyXG4gICAgICAgIDogJ1ZlcmlmaXF1ZSBhIGRpc3BvbmliaWxpZGFkZSBkb3MgaXRlbnMgaW5kaXNwb27DrXZlaXMgYW50ZXMgZGUgcHJvc3NlZ3VpcidcclxuICAgIH0pXHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvIGFvIHZlcmlmaWNhciBkaXNwb25pYmlsaWRhZGU6JywgZXJyb3IpXHJcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLmpzb24oXHJcbiAgICAgIHsgZXJyb3I6ICdFcnJvIGludGVybm8gZG8gc2Vydmlkb3InIH0sXHJcbiAgICAgIHsgc3RhdHVzOiA1MDAgfVxyXG4gICAgKVxyXG4gIH0gZmluYWxseSB7XHJcbiAgICBhd2FpdCBwcmlzbWEuJGRpc2Nvbm5lY3QoKVxyXG4gIH1cclxufVxyXG4iXSwibmFtZXMiOlsiTmV4dFJlc3BvbnNlIiwicHJpc21hIiwiZ2V0Q29tcGFueUlkRnJvbVNlc3Npb24iLCJyZXF1ZXN0Iiwic2Vzc2lvbklkIiwiY29va2llcyIsImdldCIsInZhbHVlIiwicGFydHMiLCJzcGxpdCIsImxlbmd0aCIsInVzZXJJZCIsInVzZXIiLCJmaW5kVW5pcXVlIiwid2hlcmUiLCJpZCIsImNvbXBhbnlJZCIsImVycm9yIiwiY29uc29sZSIsIkdFVCIsImpzb24iLCJzdGF0dXMiLCJwcm9kdWN0cyIsImFjY2Vzc29yaWVzIiwiZXF1aXBtZW50IiwiUHJvbWlzZSIsImFsbCIsInByb2R1Y3QiLCJmaW5kTWFueSIsInNlbGVjdCIsIm5hbWUiLCJjb2RlIiwidG90YWxNZXRlcnMiLCJwcmljZVBlck1ldGVyIiwiYWNjZXNzb3J5IiwidG90YWxRdHkiLCJwcmljZVBlclVuaXQiLCJhY3RpdmVCb29raW5ncyIsImJvb2tpbmciLCJpbiIsImluY2x1ZGUiLCJpdGVtcyIsImNsaWVudCIsImN1cnJlbnRBdmFpbGFiaWxpdHkiLCJtYXAiLCJvY2N1cGllZE1ldGVycyIsInJlZHVjZSIsInRvdGFsIiwiZmlsdGVyIiwiaXRlbSIsInByb2R1Y3RJZCIsInN1bSIsIm1ldGVycyIsImF2YWlsYWJsZU1ldGVycyIsIk1hdGgiLCJtYXgiLCJ1dGlsaXphdGlvblBlcmNlbnQiLCJyb3VuZCIsIm9jY3VwaWVkUXR5IiwiYWNjIiwiYWNjZXNzb3J5SWQiLCJxdWFudGl0eSIsImF2YWlsYWJsZVF0eSIsImVxdWlwIiwiZXEiLCJlcXVpcG1lbnRJZCIsInN1bW1hcnkiLCJ0b3RhbFByb2R1Y3RzIiwidG90YWxBY2Nlc3NvcmllcyIsInRvdGFsRXF1aXBtZW50IiwidG90YWxQcm9kdWN0TWV0ZXJzIiwicCIsInRvdGFsQWNjZXNzb3J5UXR5IiwiYSIsInRvdGFsRXF1aXBtZW50UXR5IiwiZSIsIm9jY3VwaWVkUHJvZHVjdE1ldGVycyIsIm9jY3VwaWVkQWNjZXNzb3J5UXR5Iiwib2NjdXBpZWRFcXVpcG1lbnRRdHkiLCJhdmFpbGFibGVQcm9kdWN0TWV0ZXJzIiwiYXZhaWxhYmxlQWNjZXNzb3J5UXR5IiwiYXZhaWxhYmxlRXF1aXBtZW50UXR5IiwibGFzdFVwZGF0ZWQiLCJEYXRlIiwidG9JU09TdHJpbmciLCJzdWNjZXNzIiwiJGRpc2Nvbm5lY3QiLCJQT1NUIiwiYm9keSIsInN0YXJ0RGF0ZSIsImVuZERhdGUiLCJzdGFydCIsImVuZCIsIm92ZXJsYXBwaW5nQm9va2luZ3MiLCJBTkQiLCJsdGUiLCJndGUiLCJhdmFpbGFiaWxpdHlSZXN1bHRzIiwiYWxsQXZhaWxhYmxlIiwicmVxdWVzdGVkSXRlbSIsInR5cGUiLCJ1bml0IiwiaXRlbUluZm8iLCJvY2N1cGllZFF1YW50aXR5IiwidG90YWxRdWFudGl0eSIsImF2YWlsYWJsZVF1YW50aXR5Iiwib2NjdXB5aW5nQm9va2luZ3MiLCJmb3JFYWNoIiwicHVzaCIsImJvb2tpbmdJZCIsImV2ZW50VGl0bGUiLCJjbGllbnROYW1lIiwiaXNBdmFpbGFibGUiLCJyZXF1ZXN0ZWRRdWFudGl0eSIsInJlYXNvbiIsInVuZGVmaW5lZCIsInRvdGFsSXRlbXMiLCJhdmFpbGFibGVJdGVtcyIsInVuYXZhaWxhYmxlSXRlbXMiLCJnZW5lcmFsU3RhdHVzIiwiYXZhaWxhYmxlIiwicmVzdWx0cyIsInBlcmlvZCIsIm1lc3NhZ2UiLCJyZWNvbW1lbmRhdGlvbiJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/app/api/availability/route.ts\n");

/***/ }),

/***/ "(rsc)/./src/lib/db.ts":
/*!***********************!*\
  !*** ./src/lib/db.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9zcmMvbGliL2RiLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxrQkFBa0JDO0FBSWpCLE1BQU1DLFNBQVNGLGdCQUFnQkUsTUFBTSxJQUFJLElBQUlILHdEQUFZQSxHQUFFO0FBRWxFLElBQUlJLElBQXlCLEVBQWNILGdCQUFnQkUsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsid2VicGFjazovL2xlZC1yZW50YWwtYXBwLy4vc3JjL2xpYi9kYi50cz85ZTRmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xyXG5cclxuY29uc3QgZ2xvYmFsRm9yUHJpc21hID0gZ2xvYmFsVGhpcyBhcyB1bmtub3duIGFzIHtcclxuICBwcmlzbWE6IFByaXNtYUNsaWVudCB8IHVuZGVmaW5lZFxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/PyBuZXcgUHJpc21hQ2xpZW50KClcclxuXHJcbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSBnbG9iYWxGb3JQcmlzbWEucHJpc21hID0gcHJpc21hXHJcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./src/lib/db.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../../webpack-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(rsc)/./node_modules/next/dist/build/webpack/loaders/next-app-loader.js?name=app%2Fapi%2Favailability%2Froute&page=%2Fapi%2Favailability%2Froute&appPaths=&pagePath=private-next-app-dir%2Fapi%2Favailability%2Froute.ts&appDir=C%3A%5CUsers%5Cmarco%5CDownloads%5Cled-rental-app-min%5Cled-rental-app%5Csrc%5Capp&pageExtensions=tsx&pageExtensions=ts&pageExtensions=jsx&pageExtensions=js&rootDir=C%3A%5CUsers%5Cmarco%5CDownloads%5Cled-rental-app-min%5Cled-rental-app&isDev=true&tsconfigPath=tsconfig.json&basePath=&assetPrefix=&nextConfigOutput=&preferredRegion=&middlewareConfig=e30%3D!")));
module.exports = __webpack_exports__;

})();